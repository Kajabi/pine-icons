<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Pine icons Library - {{version}}</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ðŸŒ²</text></svg>"/>

  <meta name="viewport" content="width=device-width, initial-scale=1.0 />

  <!-- Pine Design System CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@pine-ds/core@latest/dist/pine-core/pine-core.css" />
  <style>
    body {
      font-family: var(--pine-font-family-greet);
      padding: var(--pine-dimension-250);
    }

    h1, h2 {
      margin-bottom: var(--pine-dimension-500);
      background: linear-gradient(to right, #f97316, #ec4899, #8b5cf6);
        background-clip: border-box;
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
    }
    h1 {
      margin: 0 0 var(--pine-dimension-400) 0;
      font-size: var(--pine-font-size-285);
      font-weight: var(--pine-font-weight-bold);
      text-align: center;
    }
    h2 {
      font-size: var(--pine-font-size-200);
      font-weight: var(--pine-font-weight-semi-bold);
    }
    svg {
      width: var(--pine-dimension-400);
      height: var(--pine-dimension-400);
      flex-shrink: 0;
    }
    .icon-container {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(68px, 1fr));
      gap: var(--pine-dimension-300);
      padding: var(--pine-dimension-200);
    }
    .icon-button {
      background: var(--pine-color-grey-100);
      border: 1px solid var(--pine-color-grey-200);
      border-radius: var(--pine-dimension-050);
      cursor: pointer;
      padding: var(--pine-dimension-300);
      transition: all 0.2s cubic-bezier(0.34, 1.56, 0.64, 1);
      transform: translateY(0);
      display: flex;
      align-items: center;
      justify-content: center;
      aspect-ratio: 1;
    }
    .icon-button:hover {
      transform: translateY(-2px);
    }
    .icon-button:active {
      background: linear-gradient(to right, rgba(249, 115, 22, 0.1), rgba(236, 72, 153, 0.1), rgba(139, 92, 246, 0.1));
    }
    .visually-hidden {
      position: absolute;
      width: 1px;
      height: 1px;
      padding: 0;
      margin: -1px;
      overflow: hidden;
      clip: rect(0, 0, 0, 0);
      white-space: nowrap;
      border: 0;
    }
    .toast {
      position: fixed;
      bottom: var(--pine-dimension-400);
      left: 50%;
      transform: translateX(-50%);
      background: var(--pine-color-white);
      color: var(--pine-color-grey-900);
      padding: var(--pine-dimension-200) var(--pine-dimension-400);
      border-radius: var(--pine-dimension-100);
      opacity: 0;
      transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
      pointer-events: none;
      font-size: var(--pine-font-size-100);
      font-weight: var(--pine-font-weight-medium);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      border: 1px solid var(--pine-color-grey-200);
      max-width: 90vw;
      display: flex;
      align-items: center;
      gap: var(--pine-dimension-200);
    }
    .toast svg {
      width: var(--pine-dimension-300);
      height: var(--pine-dimension-300);
      flex-shrink: 0;
    }
    .toast.show {
      opacity: 1;
      transform: translateX(-50%) translateY(0);
    }
    .toast:not(.show) {
      transform: translateX(-50%) translateY(var(--pine-dimension-400));
    }
    .search-container {
      margin-bottom: var(--pine-dimension-500);
      display: flex;
      justify-content: center;
    }
    .search-input {
      width: 100%;
      max-width: 400px;
      padding: var(--pine-dimension-200) var(--pine-dimension-300);
      border-radius: var(--pine-dimension-100);
      font-family: var(--pine-font-family-greet);
      font-size: var(--pine-font-size-100);
      border: 1px solid var(--pine-color-grey-200);
      transition: all 0.2s ease;
      background: var(--pine-color-grey-100);
    }
    .search-input:focus {
      outline: none;
      border-color: #8b5cf6;
      box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.1);
      background: var(--pine-color-white);
    }
    .search-input::placeholder {
      color: var(--pine-color-grey-400);
    }
    .empty-state {
      display: none;
      text-align: center;
      padding: var(--pine-dimension-800) var(--pine-dimension-400);
      color: var(--pine-color-grey-500);
      grid-column: 1 / -1;
    }
    .empty-state-text {
      font-size: var(--pine-font-size-200);
      font-weight: var(--pine-font-weight-medium);
      background: linear-gradient(to right, #f97316, #ec4899, #8b5cf6);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
    }
    .icon-count-container {
      display: flex;
      justify-content: center;
      align-items: center;
    }
    .icon-count {
      display: inline-block;
      color: var(--pine-color-white);
      background: linear-gradient(to right, #f97316, #ec4899, #8b5cf6);
      text-align: center;
      padding: var(--pine-dimension-050) var(--pine-dimension-150);
      border-radius: var(--pine-border-radius-full);
      font-size: var(--pine-font-size-100);
    }
    @media (max-width: 500px) {
      .icon-container {
        gap: var(--pine-dimension-100);
      }
    }
  </style>
</head>
<body>
<div class="icon-count-container">
  <p class="icon-count">{{count}} icons</p>
</div>
<h1>Pine Icons - {{version}}</h1>
<div class="search-container">
  <label for="search" class="visually-hidden">Search all {{count}} icons</label>
  <input type="text" id="search" class="search-input" placeholder="Search icons by name or tag..." oninput="filterIcons(this.value)">
</div>

<div class="icon-container">
  <div class="empty-state">
    <div class="empty-state-text">Sorry, that icon doesn't exist yet. Try another search!</div>
  </div>
  {{content}}
</div>

<div id="toast" class="toast" role="alert" aria-live="polite"></div>

<script>
let toastElement = null;

function filterIcons(searchTerm) {
  const normalizedSearch = searchTerm.toLowerCase().trim();
  const icons = document.querySelectorAll('.icon-button');
  const emptyState = document.querySelector('.empty-state');
  let visibleCount = 0;

  icons.forEach(icon => {
    const tags = icon.getAttribute('data-tags') || '';
    const iconName = icon.getAttribute('data-icon-name') || '';
    const shouldShow = !normalizedSearch ||
      tags.toLowerCase().includes(normalizedSearch) ||
      iconName.toLowerCase().includes(normalizedSearch);

    icon.style.display = shouldShow ? '' : 'none';
    if (shouldShow) visibleCount++;
  });

  emptyState.style.display = visibleCount === 0 ? 'block' : 'none';
}

document.addEventListener('DOMContentLoaded', () => {
  // Initialize toast element
  toastElement = document.getElementById('toast');
  if (!toastElement) {
    console.error('Toast element not found, creating one');
    toastElement = document.createElement('div');
    toastElement.id = 'toast';
    toastElement.className = 'toast';
    toastElement.setAttribute('role', 'alert');
    toastElement.setAttribute('aria-live', 'polite');
    document.body.appendChild(toastElement);
  }

  // Add click handlers to buttons
  document.querySelectorAll('.icon-button').forEach(button => {
    button.addEventListener('click', () => {
      const iconName = button.getAttribute('data-icon-name');
      copyToClipboard(iconName);
    });
  });
});

function showToast(message, iconContent = '') {
  if (!toastElement) return; // Guard against null toast

  if (iconContent) {
    toastElement.innerHTML = `${iconContent}<span>Icon code has been copied.</span>`;
  } else {
    toastElement.innerHTML = `<span>${message}</span>`;
  }

  toastElement.classList.add('show');

  // Remove existing timeout if any
  if (toastElement.timeoutId) {
    clearTimeout(toastElement.timeoutId);
  }

  // Set new timeout
  toastElement.timeoutId = setTimeout(() => {
    toastElement.classList.remove('show');
  }, 3000);
}

async function copyToClipboard(iconName) {
  try {
    const code = `<pds-icon name="${iconName}"></pds-icon>`;
    const button = document.querySelector(`[data-icon-name="${iconName}"]`);
    const svgContent = button ? button.innerHTML : '';

    await navigator.clipboard.writeText(code);
    showToast(code, svgContent);
  } catch (err) {
    console.error('Failed to copy:', err);
    showToast('Failed to copy code');
  }
}
</script>
</body>
</html>
